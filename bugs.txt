eachfn depth handling
unionfn bitarray case

todo:
bitarray indexes
